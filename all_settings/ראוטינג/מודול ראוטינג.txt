ב"ה

מודול ראוטינג
type=routing
קישורים לתוספים שניתנים להגדרה בכל מודול
רשימת כל ההגדרות שניתנות להטמעה בכל מודול
הגדרות זיהוי בכניסה לשלוחה
הסבר על הודעת ברוכים הבאים (הודעה ראשונה בשלוחה)
הרשאות כניסה לשלוחה
לאיזה מספר לחייג
ישנם כמה אופציות לאיזה מספר/ים לחייג.

א. ניתוב למספר בודד.
ב. בחירה לאיזה שלוחה לנתב, כאשר כל שלוחה מנתבת למספר כלשהי.
ג. ניתוב לכמה מספרים ביחד (שכאשר הראשון עונה, השיחה מפסיקה לצלצל לכולם).
ד. ניתוב לכמה מספרים, בסדר מסוים, ועם הגבלת כמות.
ה. ניתוב לכל מספר שמקישים (וכן הגדרת חיוג מקוצר).

ניתוב למספר בודד
באם רוצים שהשיחה תנותב תמיד שלמספר מסוים, יש להגדיר

type=routing
routing_to_phone=0581234567
כאן בדוגמה, המערכת תנתב מיידית לטלפון 0581234567.

ניתוב לכמה מספרים - מבוא
בכל שאר סוגי הניתוב משתמשים בכמה מספרים, וע"כ בכל המקרים האלו יש להגדיר את רשימת המספרים שאליהם תרצו לנתב.
את המספרים מגדירים כך

routing1=0501111111
routing2=0523333333
routing3=0533133333
routing4=0548444444
ובנוסף יש להגדיר את סוג הניתוב המרובה

בחירה לאיזה שלוחה לנתב, כאשר כל שלוחה מנתבת למספר כלשהי.
ברירת מחדל מבקש להקיש את מספר השורה אליו נרצה לנתב, M1039 "אנא הקישו את מספר השלוחה לניתוב וסולמית", וכאשר מקישים מקש כלשהי המערכת תנתב למספר המוגדר על מקש זה.
לפי הדוגמה הנ"ל: אם יקישו על מקש 1 המערכת תנתב למספר 0501111111, אם יקישו על מספר 2 המערכת תנתב למספר 0523333333, וכן הלאה.

דוגמה להגדרה של שלוחה כזו

type=routing
routing1=0501111111
routing2=0523333333
אם יש יותר מעשר נציגים, ניתן להגדיר את ההגדרה הבאה

digits=2
ואז המערכת תחכה שהמאזין יקיש 2 מקשים, וכן הלאה.

בנוסף ברירת מחדל הקשה על כוכבית מחזיר לתפריט הראשי, והקשה על סולמית מחזיר לשלוחה הקודמת, אם רוצים לשנות ניתן להגדיר

root=9
כאן בדוגמה מוגדר שהקשה על 9 יחזיר לשלוחה הראשית.

up=7
כאן בדוגמה מוגדר שהקשה על 7 מחזיר לשלוחה הקודמת.

ניתוב למספר בודד
אם רוצים באופן זמני להגדיר שכל השיחות יופנו למספר אחד מהרשימה, ניתן להוסיף את השורה

routing_start=1
כאן בדגמה ינתב מייד לשורה 1, כלמר למספר 0501111111.

דוגמה להגדרה כזו

type=routing
routing_start=1
routing1=0501111111
routing2=0523333333
כאן בדוגמה גם אם יש רשימה של מספרים, יעביר תמיד לשורה 1.

ניתוב לכמה מספרים ביחד (שכאשר הראשון עונה, השיחה מפסיקה לצלצל לכולם).
בכדי שהשיחה תנותב לכמה מספרים ביחד, יש להוסיף את השורה

routing_multiple=yes
ובנוסף להוסיף גם לאיזה שורות לנתב, כאשר ביניהם מפריד פסיק

routing_multiple_numbers=1,3
דוגמה לשלוחה כזו

type=routing
routing_multiple=yes
routing_multiple_numbers=1,3
routing1=0501111111
routing2=0523333333
routing3=0533133333
routing4=0548444444
כאן בדוגמה ינתב מייד לשורה 1 ולשורה 3, כלומר למספר 0501111111 ולמספר 0533133333, והראשון שיענה לשיחה, זה יפסיק לשני.

ניתוב לכמה מספרים, בסדר מסוים, ועם הגבלת כמות.
אם רוצים שהשיחה תנותב לפי הסדר, וכן יוכלו להגדיר כמה מספרים לנתב לכל מספר (לדוגמה כאשר כל מספר הוא בעצם מוקד עם כמה נציגים שעונים, ורוצים שכמות השיחות המופנות למספר הזה יהיה רק ככמות הנציגים שעונים), יש להוסיף את השורה

routing_count=yes
ובנוסף חובה להגדיר לכל מספר עד כמה אנשים להפנות למספר זה, וזאת ע"י השורה

routing_count_1=5
כאן בדוגמה למספר 1, המערכת תעביר 5 שיחות, ואחר כך המערכת יתחיל להעביר שיחות למספר השני.

במקרה שכל המוקדים תפוסים (כלומר המערכת כבר העבירה לכל מוקד, את מקסימום השיחות שניתן להעביר, ועדיין אף אחד לא ניתק), המערכת תבצע כל 3 שניות, בדיקה האם יש מוקד שהתפנה, וא"כ תעביר אליו את השיחה.
אם רוצים ניתן להוסיף לשלוחה קבצי שמע, ואת זה ישמעו במהלך ההמתנה למוקד פנוי (שימו לב! לא מדובר כאן על מוזיקה בהמתנה ששומעים עד שנציג עונה, אלא קבצי שמע ששומעים עד שמתפנה מוקד).
את קבצי השמע מוסיפים לשלוחה כמו שלוחה רגילה, 000, 001, 002,.....,
במקרה ששמו קבצים, המערכת תבצע בדיקה בין קובץ לקובץ האם כבר התפנה מוקד (ולכן מומלץ שהקבצים לא יהיו מידי ארוכים, (ניתן לעשות קבצים באורך של 3 שניות...), כך שהמערכת תבצע את הבדיקה על מוקד פנוי בתכיפות).

דוגמה לשלוחה המוגדרת כנ"ל.

type=routing
routing_count=yes
routing1=0501111111
routing_count_1=5
routing2=0523333333
routing_count_2=7
כאן בדוגמה המערכת תנתב קודם 5 שיחות לשורה 1 כלומר למספר 0501111111, ואח"כ תנתב 7 שיחות לשורה 2 כלומר למספר 0523333333.

ברית מחדל בזמן ההמתנה עד שנציג יוכל לקבל את השיחה,
המערכת תשמיע את הקבצים המוגדרים, כאשר בין קובץ לקובץ המערכת בודקת האם מספר הממתינים כבר מאפשר מעבר לנציג שהתפנה

תפריט מעבר להשארת פרטים
ברית מחדל, המערכת משמיעה את הקבצים, כאשר בין קובץ לקובץ בודקת האם כמות הממתינים ירד מהמקסימום, וכבר ניתן לעבור,
באם עדיין לא ניתן - המערכת משמיעה עוד קובץ של המתנה

באם רוצים שהמערכת תתן אפשרות של תפריט
M2574 "כל העמודות תפוסות להשארת הודעה הקישו 1 להמשך המתנה הקישו 2 או המתינו"
ותאפשר יציאה להשארת פרטים ניתן להגדיר

routing_count_wait_menu=yes
ברירת מחדל - המערכת תשמיע את התפריט כל 3 קבצים של המתנה,
באם ברצונכם להגדיל או להקטין את הכמות של הפעמים להשמעת התפריט בין הקבצים ניתן להגדיר

routing_count_wait_menu_play=4
בדוגמא כאן המערכת תשמיע את התפריט למעבר כל 4 פעמים

ברירת מחדל מי שמקיש 1 - כלומר בחר בהמתנה לצאת להשארת פרטים, פרטיו נשמרים בקובץ בשם שנמצא בשלוחה
RoutingCountWaitMenuExit.ymgr RoutingCountWaitMenuExit.html
לאחר מכן המערכת מודיעה
M1447 נרשמת בהצלחה
וחוזרת שלב אחורה,

ניתן להגדיר ניתוק

routing_count_wait_menu_goto=hangup
או מעבר לשלוחה אחרת (לצורך רשיום נתונים בשלוחה אחרת או כל דבר9

routing_count_wait_menu_goto=/5/8
במקרה כזה המערכת תרשום את הפרטים בקובץ RoutingCountWaitMenuExit.ymgr אבל לא תשמיע את הודעה M1447 נרשמת בהצלחה

ניתוב לכל מספר שמקישים (וכן הגדרת חיוג מקוצר).
אם רוצים שבנוסף יוכלו גם להקיש כל מספר ושהשיחה תנותב למספר שהקישו (והשורות המוגדרות יהפכו לחיוג מקוצר), ניתן להוסיף את השורה

routing_any_phone=yes
זהירות! בשלוחה כזו כל אחד יכול להתקשר לכל מספר.

דוגמה לשלוחה כזו

type=routing
routing_any_phone=yes
routing1=0501111111
routing2=0523333333
כאן בדוגמה יצטרכו להקיש את המספר המלא להתקשר, וכן יוכלו להקיש 1 וסולמית ואז יתקשר לשורה 1 כלומר למספר 0501111111, או 2 וסולמית ויחייג לשורה 2 כלומר למספר 0523333333.

הגדרות כלליות לשלוחת ניתוב
במודול ראוטינג, ניתוב שיחה לכל מספר הינה בעלות של יחידה לדקה (נמדד בשניות), למעט כאשר השיחה מנותבת ל 1800 שזה חיוג חינם.

מוזיקה בהמתנה
אם רוצים, ניתן לשנות את המוזיקה בהמתנה ע"י ההגדרה

music_on_hold=
ויש לשים את שם המוזיקה.

ניתן לשלוח לשירות הלקוחות מוזיקה בהמתנה כדי שתוכלו להגדיר זאת בקו, להלן כמה סוגים שכבר מובנות בקו.

לחילופין ניתן להגדיר שלא יהיה מוזיקה, אלא צליל חיוג רגיל, וזאת ע"י ההגדרה

music_on_hold=no
מוסיקה מובנת
שימו לב!, הזכויות שמורות לחברת ימות המשיח.
אם יהיה ביקוש נוסיף שירים נוספים לספריית המוסיקה לבחירה.

צמאה
מוסיקה בלבד

music_on_hold=ztomao
מוסיקה עם הודעה "שיחתכם חשובה לנו"

music_on_hold=ztomao+patiach
מוסיקה וואקלית לשלושת השבועות

music_on_hold=Vocal
זיהוי שיחה
ניתן להגדיר את זיהוי השיחה היוצאת בכמה אפשרויות.
ברירת מחדל השיחה מנותבת עם מספר המחייג
אם רוצים שיופיע מספר המערכת יש להגדיר

routing_your_id=did
לתשומת ליבכם! המספר שיופיע זה מספר המערכת הראשית.
לחילופין ניתן להגדיר מספר מיוחד שיהיה הזיהוי

routing_your_id=special.0501234567
בדוגמה כאן הזיהוי שיופיע על הצג יהיה 0501234567.

שימו לב!, הגדרה זו תעבוד רק במספרים משניים של המערכת, וכן מספרים מאושרים לזיהוי מיוחד.
ניתן להוסיף מספרים באופן עצמאי עבור זיהוי מיוחד. (להסבר על הגדרת מספר מאושר לזיהוי לחץ כאן).

אפשרות נוספת לבצע זיהוי מיוחד עם מספרים שונים בצורה רנדומאלית

היינו שבכל ניתוב השיחה תצא עם זיהוי של מספר אחר.

ההגדרה בקובץ ext.ini שבשלוחה היא:

routing_your_id=special_random
ניתן להגדיר זאת גם בשלוחה הראשית בקובץ ivr.ini.

בנוסף להגדרה הנ"ל -special_random- יש ליצור קובץ בשלוחה בשם:

RoutingSpecialRandom.ini

בקובץ יש לרשום מספרים לזיהוי, ניתן להכניס רק מספרים מאושרים לזיהוי (להסבר על הגדרת מספר מאושר לזיהוי לחץ כאן).
וכן את מספר המערכת ומספרי משנה למערכת.

שימו לב הקובץ חייב להיות בשלוחה עצמה אחרת הניתוב יצא עם זיהוי של המתקשר

דוגמא למופיע בקובץ:

0799123456
0500123456
בדוגמא זו השיחה תצא פעם עם זיהוי של מספר 0799123456 ופעם עם זיהוי של מספר 0500123456.

לא לשדר מענה למחייג, עד שמי שחייגו אליו עונה

call_no_answer=yes
הסבר: במידה ומוגדר ניתוב בשלוחה ראשית, ההגדרה הזו אומרת למערכת לא לשדר מענה עד שהצד השני עונה
(דוגמא, מי שרוצה לפתוח וואטספ על המספר מערכת, ולא רוצה לפספס את תחילת הקוד עד שהוא עונה, אם נגדיר את ההגדרה הזו, המערכת לא תשדר מענה, עד שאני באמת יענה לשיחה)

הודעה בצד העונה לפני התחלת השיחה
ניתן לעשות שמקבל השיחה ישמע הודעה לפני התחלת השיחה, וזאת ע"י ההגדרה

routing_answer_play=yes
ההודעה המושמעת היא M1692
ברירת מחדל זה ג'ינגל של ימות המשיח
כמובן שתוכלו להחליף להודעה משלכם על ידי החלפת ההודעה

לתשומת לבכם, מומלץ בהודעה להשאיר 2 שניות רווח בהתחלה ורק לאחר מכן לשים את ההודעה שלכם, (2 שניות זה הזמן של העניה ומרווחים בין חברות התקשורת)
אורך ההודעה לא מומלץ מעל 7 שניות כי גם ככה אנשים מחכים בצד השני של הקו.

תפריט האם לקבל את השיחה או לדחותה
ניתן להגדיר שהעונה לשיחה יהיה לו תפריט האם לקבל את השיחה או לדחות אותה, ע"י ההגדרה

routing_answer_tfr=yes
ואז כאשר עונים לשיחה יהיה תפריט, M1693 "שיחה זו מועברת אליכם באמצעות הפלטפורמה הטכנולגית של ימות המשיח, לקבלת השיחה הקישו 1, לדחיית השיחה הקישו 2"

באם העונה דחה את השיחה, המאזין חוזר לתפריט.
אם רוצים שיילך לשלוחה אחרת, ניתן להגדיר

routing_answer_tfr_hangup_goto=/1
כאן בדוגמה ילך לשלוחה 1 שתחת השלוחה הראשית.

יתן לראות לוג של מי ענה ומי דחה -
בתוך התיקיה של החיוג בקובץ LogRoutingAnswerTfr
וכן בתיקית LOG בקובץ LogRoutingAnswerTfr

הגבלת זמן ההמתנה
ניתן להגביל את זמן ההמתנה, וזאת ע"י ההגדרה

routing_end_time=20
כאן בדוגמה זמן ההמתנה יהיה 20 שניות.

אחרי הזמן הנ"ל המאזין יסיים בשלוחה.

הקלטת השיחה
ברירת מחדל מקליט את כל השיחות, אם רוצים שלא יקליט יש להגדיר

routing_record=no
שליחת השיחות למייל
ברירת מחדל השיחות נשלחות למייל, אם רוצים שלא ישלח, יש להגדיר

routing_email_send=cancel
האימיל אליו נשלחים השיחות הוא האימייל המוגדר במערכת, אם רוצים שיישלח למייל אחר ניתן להגדיר

routing_email_address=ddd@gmail.com
כאן בדוגמה יישלח למייל ddd@gmail.com

ברירת מחדל השם שכתוב במייל הוא השם שכתוב כשם בעל המערכת, אם רוצים שיהיה כתוב שם אחר יש להגדיר

routing_email_name=אברהם
מקש לניתוק לסיום השיחה
ניתן להגדיר שאם מקישים על כוכבית אז השיחה מסתיימת.
להגדרה שמי שחייג יכול להקיש כוכבית

routing_ok_allow_caller_hangup=yes
להגדרה שמי שקיבל את השיחה יכול להקיש כוכבית.

routing_ok_allow_callee_hangup=yes
להישאר על הקו בסיום שיחה
כאשר השיחה מסתיימת, או ע"י שאחד הצדדים מנתק את השיחה, או ע"י הקשת כוכבית וכנ"ל, ברירת מחדל שני הצדדים מתנתקים, אם רוצים שמי שחייג מהמערכת, לא יתנתק, אלא ימשיך וייצא מהשלוחה, יש להגדיר

routing_end_next=yes
מעבר בסיום בשלוחה
ברירת מחדל לאחמ"כ חוזר שלב אחד אחורה ניתן להגדיר מעבר לשלוחה אחרת או ניתוק | ראה כאן את האפשרויות להגדרה.
ההגדרה היא:

routing_end_goto=/8
בדיקה האם הולך להיגמר\לפוג היחידות:

ניתן להגדיר שאם אין כמות מסויימת של יחידות או שהולך לפוג תוקפם המערכת תשלח מייל.

שימו לב! המערכת שולחת מייל אחד כל יום. יום = 12 בלילה

ההגדרה היא:

checking_units=yes
כמה יחידות מינימום ישלח מייל: (בחירת מחדל מתחת ל100):

checking_units_amount_units_to_warning=XX
ניתן להגדיר בנוסף או בנפרד בדיקה שהתוקף שלהם הולך לפוג: (בחירת מחדל 30 יום):

checking_units_to_days_expire=XXX
ניתן להגדיר מייל נפרד מהמייל של המערכת הראשי לשליחת ההתראה:

checking_units_mail=mail@mail.com
שימו לב, הבדיקה נעשת רק באם כרגע כבר יש יחידות לחיוג. באם אין יחידות המערכת תשמיע רגיל "אין מספיק יחידות" ותחזור שלב למעלה.

דוחות
בכל שיחה שתישלח למייל יהיה גם קובץ הדוח, בשם LogRouting.ini.
ברירת מחדל לתרגום המילים בדוח

LogRouting=דו"ח שיחות יוצאות
Folder=שלוחה
DID=מערכת
IdType=סוג זיהוי
teudat_zehut=תעודת זהות
digits=הקשת ספרות
list=רשימה
phone=טלפון
enter_phone_list=רשימת טלפונים
EnterId=מספר זיהוי
ValName=שם
Phone=טלפון
Date=תאריך
Time=שעה
HebrewDate=תאריך עברי
Module=סוג שלוחה
Routing=מספרים לחיוג
YourID=זיהוי יוצא
DialStatus=מצב השיחה
CONGESTION=שגיאה
NOANSWER=אין תשובה
BUSY=עסוק
ANSWER=נענה
CANCEL=ביטול
DialTime=אורך כלל השיחה
AnswerTime=זמן שיחה
AnswerNumber=מספר שנענה
HangupBeforeDial=ניתוק לפני חיוג
ApiSandAnswer=תשובת שרת
 
ניתן לשנות למילים שלכם.
כמו"כ ניתן להסיר עמודות ע"י ההגדרה
Date=_hidden
כאן בדוגמה העמודה Date לא תופיע.

שליחה לשרת חיצוני של סטטוס סיום הלקוח בחיוג
המערכת תשלח מיד לאחר יציאת לקוח מהחיוג את כל הפרטים שהיה בחיוג
אותם פרטים שנמצאים בקובץ LogRouting.ymgr LogRouting.html

ערכי חובה

routing_api_send=yes
routing_api_link=abc.co.il
ברירת מחדל get ניתן לשנות שליחה לpost

routing_api_url_post=yes
במידה ועניתם בהצלחה
יצטרף לדוח LogRouting.ymgr LogRouting.html
התשובה שעניתם מהשרת על שליחת כל הפרטים (מקסימום 5 אותיות לצירוף לדו"ח)

הערך בדוח יהיה
ApiSandAnswer=תשובת שרת

