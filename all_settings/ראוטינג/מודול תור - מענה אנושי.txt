מודול תור - queue
הגדרת המודול

type=queue
בשביל שהמודול יעבוד מספיק להכניס את ההגדרה הנ"ל (סוג השלוחה) בקובץ ext
ולרשום את מספרי הטלפון של הנציגים בקובץ queue, ברגע שתעשו זאת השלוחה תעבוד עם הגדרות ברירת המחדל
הסבר מפורט על אופן יצירת הקבצים תמצאו כאן

ניתן לערוך את ההגדרות לפי ההעדפות שלכם שימו לב שאת ההגדרות כאן מנהלים ב2 קבצים שונים

1.	ext.ini	הגדרות שקשורות לאיך להפעיל או איך להתנהג אחרי סיום התור
2.	queue.ini	רשימת הנציגים וכן הגדרות שקשורות לתור עצמו
בתחילת כל פוסט צויין באיזה קובץ יש להגדיר את ההגדרות שנכתבו באותו פוסט, אלא אם כן צויין על הגדרה מסויימת שהיא שייכת לקובץ השני כמו"כ ההגדרה צוינה בהבלטה כזו, ולא כרגיל

קישורים למודול
הזיהוי של המתקשרים	הגדרות בקובץ ext
אורך המתנה מקסימלי והעברת השיחה כשאין מענה / בהקשת 9	הגדרות בקובץ ext
דחיית השיחה ע"י הנציג, ומעבר בכשלונות נוספים	הגדרות בקובץ ext
שליחת דוחות והקלטות למייל	הגדרות בקובץ ext
זמני החיוג לנציגים, ומנוחה בין שיחה לשיחה	הגדרות בקובץ queue
הגדרות והודעות ללקוח בזמן ההמתנה	הגדרות בקובץ queue
יציאה מהתור במהלך התור (שימושי להשארת מספר לחזרה)	הגדרות בקובץ queue
הנציגים אליהם התור יחייג ואסטרטגיית התור	הגדרות בקובץ queue
מוזיקה בהמתנה	הגדרות בקובץ queue (על הגדרה זו לא יפעל הערך של הפעלה משלוחה אחרת)
שהגדרות של קובץ queue ילקחו משלוחה אחרת	הגדרה בקובץ ext
טעינת הגדרות תור ב-API	הגדרה בקובץ ext
שליחת סטטוס סיום תור לשרת חיצוני API	הגדרה בקובץ ext
עריכת הדוחו"ת	הודעות מערכת קשורות וערכים שלא נבדקו לעומק
למפתחים
קבלת מידע בזמן אמת על שלוחת תור ב-API

קישורים חיצוניים
להגבלת הזמן שבו יהיה ניתן לחייג לנציגים ניתן להשתמש בהגבלת כניסה לשלוחה לפי זמנים (בקובץ ext כמובן).
ניתן להגדיר כמה שלוחות של מענה שבכל שלוחה יהיו נציגים אחרים ולהגדיר שלכל שלוחה יעברו בשעות שונות עם המודול הזה וכמובן להגדיר כל הגדרה אחרת שתרצו

מודול תור הוא בחיוב יחידות
מכיון שהשיחה היא שיחה יוצאת מהמערכת ועולה כסף לחברת ימות המשיח על כל דקת שיחה תחוייבו ביחידה אחת (החיוב הוא לפי שניות, אם דיברתם רק חצי דקה תחוייבו בחצי יחידה).

באם השיחה שנענת היא חיוג פנימי - דהיינו אם המספרים לחיוג הם מערכת בימות המשיח (באותו שרת), והשלוחה הראשית של המערכת מוגדרת כ ראוטינג - routing או ניתוב IP, או ניתוב לIAX או לשיחת SIP (וכן במערכות שמוגדרות כ IAX או SIP וכן בהעברת השיחה למשתמש טלגרם לא יהיה חיוב יחידות על מודול תור.

שימו לב!! רק סוגי השלוחות הנזכרות יהיו ללא חיוב יחידות. כמו"כ: יתכן שחיוב היחידות יחזור בעתיד וזה כפוף לשיקול דעתה של חברת ימות המשיח

הגדרת תור כ"לא פעיל"
כברירת מחדל, התור מוגדר כ"פעיל" כך שבכניסה לשלוחה המערכת מחייגת למספרים ברשימה בהתאם להגדרות התור.
ניתן להגדיר את התור כ"לא פעיל" ואז בכניסה לשלוחה תושמע הודעה M3790 "התור סגור כעת, אנא נסה שנית בשעות הפעילות" והמשתמש ייצא מהשלוחה.
ההגדרה היא בקובץ queue.ini

queueactive=0
במקרה כזה, התור יוגדר כ"לא פעיל" ובדו"ח שיחות יירשם שהשיחה לא נענתה בגלל שהתור לא היה פעיל (NotActive)

טיפ! תוכלו לשנות את ההגדרה גם בשיחה טלפונית באמצעות המודול הזה והמודול הזה
טיפ נוסף: תוכלו להגדיר פג תוקף להגדרה דהיינו שרק עד זמן מסויים התור יהיה לא פעיל כמופיע כאן
ראה גם:

מחירון יחידות

התראה על כמות נמוכה של יחידות

לצפייה בסטטיסקת תורים כנסו לאתר ניהול מערכת תורים
לפרטים על האתר הנ"ל

קישורים לתוספים שניתנים להגדרה בכל מודול
רשימת כל ההגדרות שניתנות להטמעה בכל מודול
הגדרות זיהוי בכניסה לשלוחה
הסבר על הודעת ברוכים הבאים (הודעה ראשונה בשלוחה)
הרשאות כניסה לשלוחה
 6  
ששמחה - זו הסיסמא  24 ביוני 2021, 11:59
הזיהוי של המתקשרים - הגדרות בקובץ ext ⬆
הדגשים: לא ניתן לצאת עם זיהוי חו"ל בישראל
לכן הקפידו להגדיר בזיהוי היוצא מספר ישראלי
במידה ומנסים לשדר מספר שאינו ישראלי - המערכת תעדכן את המספר הישראלי של המערכת שלכם

לחו"ל ניתן לצאת עם זיהוי מקומי או זיהוי ישראלי ללא הגבלה

ברירת מחדל מצלצל עם זיהוי של טלפון הלקוח. במידה ורוצים שיופיע זיהוי המספר המערכת הראשי:

queue_caller_id=customer_did
במידה שרוצים שיופיע המספר מערכת אליו חייג הלקוח, יש להגדיר:

queue_caller_id=real_did
במידה שרוצים שיופיע מספר משוייך אחר יש להגדיר את המספר:

queue_caller_id=0773137770
במידה שהזיהוי לא מאושר זה יצא עם זיהוי הטלפון של הלקוח.

זיהוי מיוחד לפי מספר ספציפי או לפי נציג ספציפי
ניתן להגדיר שאם מספר מסויים מתקשר לתור יופיע אצל הנציגים מספר מיוחד, או שבנציג מסויים יופיע מספר אחר לא משנה מי מתקשר.

ההגדרות לזה נמצאות בקובץ QueueCallerIds.ini בשלוחה של התור.

על מנת להגדיר שאם מספר 0521234567 יתקשר לתור אצל כל הנציגים יופיע זיהוי 0771234567 יש להכניס בקובץ שורה:

P-0521234567=0771234567
על מנת להגדיר שנציג עם מספר 0521654321 תמיד יראה על הצג את זיהוי 0771654321 לא משנה מי מתקשר יש להכניס בקובץ שורה:

M-0521654321=0771654321
במקרה של נציג SIP יש להכניס את המספר של הנציג בדיוק כמו בקובץ תורים.
הזיהוי היוצא ישתנה בכפוף לזה שהוא קיים כמאושר/זיהוי משנה במערכת + הוא מספר ישראלי תקין.
ההגדרה של הוספת ספרות בסוף המספר תיהיה על גבי המספר הספיציפי שיהיה בסופו של בדיקות.
הוספת ספרות לזיהוי בסוף המספר
בעבר, היה אפשרות להוסיף את הספרה "1" בתחילת המספר לזהות שהשיחה מועבר מהמערכת
לאור שינוי רגולטורי, נמצא פתרון אחר - הוספת ספרות בסוף המספר

queue_your_id_add=123456
המערכת תומכת בהוספת של עד 6 ספרות,
בדוגמא המערכת תוסיף לאחר הזיהוי שהגדרתם - את הספרות 123456

 7  
ששמחה - זו הסיסמא  24 ביוני 2021, 12:00
אורך המתנה מקסימלי והעברת השיחה כשאין מענה / בהקשת 9 - הגדרות בקובץ ext ⬆
יציאה מהתור בהקשת 9, שימושי להשארת מספר לחזרה
ברירת מחדל לא ניתן לצאת (ע"י מקש 9) במהלך התור במידה והגדרתם בקובץ הגדרות התור (queue.ini) שניתן לצאת: context=IVR2_QueueExit9 ברירת מחדל חוזר שלב אחד אחורה ניתן להגדיר מעבר לשלוחה אחרת או ניתוק | ראה כאן את האפשרויות להגדרה.

queue_exit=/5/8
בדוגמא עובר לשלוחה /5/8.

ניתן להגדיר מעבר לשלוחות אחרות כך שניתן להקליט בהודעה M2780 הודעה משלכם כגון להשארת פרטי טלפון לחזרה הקישו 9 להמשך המתנה הקישו X (כל מקש שאינו תשע). ניתן להגדיר לעבור לשלוחה של אישורים או שלוחה של קבלת נתונים וכך לקבל את המידע ולחזור איליו.

אורך ההמתנה המקסימלי
ברירת מחדל המערכת מחייגת לנציגים שוב ושוב במשך 600 שניות (10 דקות) ולאחמ"כ חוזרת שלב אחד אחורה לשינוי הזמן של ההמתנה (בשניות) יש להגדיר בקובץ ext

queue_timeout=1200
בדוגמא, משך ההמתנה בתור יהיה 1200 שניות שזה 20 דקות עד שיעבור שלב אחד אחורה או לאיפוא שמוגדר בהגדרה הבאה

להיכן יועבר הלקוח כשנגמר הזמן של התור ולא היה מענה מנציג, ברירת מחדל חוזר שלב אחד אחורה ניתן להגדיר מעבר לשלוחה אחרת או ניתוק | ראה כאן את האפשרויות להגדרה.

queue_end_timeout_goto=/5/8
 2  
ששמחה - זו הסיסמא  24 ביוני 2021, 12:09
דחיית השיחה ע"י הנציג, ומעבר בכשלונות נוספים - יש להגדיר בקובץ ext ⬆
אפשרות תפריט בחירה של נציג האם לקבל את השיחה
שימו לב כי מענה תפריט על ידי נציג הינה בחיוב של חצי יחידה, כלומר ברגע שנציג ענה ושומע את תפריט הבחירה, המערכת מבצעת חיוב של חצי יחידה, במקרה שהנציג דוחה את השיחה - זה החיוב היחיד עבור השיחה, במקרה שהשיחה נענית , יש בנוסף את החיוב בהתאמה לשיחה שנענית לפי יחידות.

להפעלת התפריט לנציגים

queue_answer_tfr=yes
במקרה כזה כאשר הנציג עונה לשיחה הוא ישמע את התפריט

M3791 שיחה זו מועברת אליכם באמצעות הפלטפורמה הטכנולוגית של ימות המשיח, לקבלת השיחה הקישו 1. להחזרת המתקשר להמתנה לנציג הבא שיתפנה הקישו 2. להוצאת המתקשר מהתור הקישו 3.

במידה והנציג הקיש על 2, המערכת תמשיך לחפש חיוג לנציגים נוספים לפי הסדר שהגדרתם, במידה והנציג הקיש על 3 - יציאה מהתור
בכל המצבים שיפורטו להלן ברירת מחדל המערכת תחזיר את המשתמש שלב אחד אחורה | בכל האפשרויות של מעבר לשלוחה אחרת ניתן להגדיר את כל האופציות המפורטות כאן כולל ניתוק.

queue_end_answer_tfr_goto=/2
טיפ: במקרה שברצונכם להחזיר את המתקשר לתור, אבל "לזרוק" אותו לתחילת התור, כלומר שימתין את כל התור מחדש, הגדירו הוצאת משתמש מהתור - לשלוחה שבה יהיה כתוב לחזור לאותו שלוחה.

מעבר במצבים נוספים
כשהשיחה הסתיימה בהצלחה והנציג ניתק את השיחה והלקוח לא ניתק את השיחה,

queue_end_continue_goto=/5/8
אם התור היה מלא בממתינים ולא היה ניתן להיכנס אליו ניתן לבגדיר לאיזה שלוחה יעבור (הגדרת כמות המקסימום נעשית בקובץ queue ראה כאן.

queue_end_full_goto=/5/8
כשאין מספרים לחיוג
המערכת משמיעה הודעה:
M1460 "אין מספרים לחיוג אנא הוסיפו מספרים לחיוג ונסו שנית"

queue_end_no_members_goto=/1
להסבר על האפשרויות במעבר לשלוחות השונות כולל ניתוק ראה כאן

כשהתור מוגדר כ"לא פעיל" (בערך queueactive)
המערכת משמיעה הודעה:
M3790 "התור סגור כעת, אנא נסה שנית בשעות הפעילות"

queue_not_active_goto=/1
להסבר על האפשרויות במעבר לשלוחות השונות כולל ניתוק ראה כאן

כישלון שאינו מהסוגים הנ"ל כגון מספרים לא תקינים.

queue_end_goto=/5/8
להסבר על האפשרויות במעבר לשלוחות השונות כולל ניתוק ראה כאן

 4  
ששמחה - זו הסיסמא  24 ביוני 2021, 12:23
שליחת דוחות והקלטות למייל - הגדרות בקובץ ext ⬆
הדוחות הינם יומיים לכל יום יהיה דו"ח נפרד (קובץ ymgr וכן המרה לקובץ html) ונשמרים בשלוחה
ההקלטות נמצאות בתוך סל המחזור במערכת שלכם למשך 30 יום, תחת תיקיית QueueRecord
ולכן ברירת מחדל הוא שהקבצים לא נשלחים למייל ניתן להגדיר שליחה.

להגדרת שליחת ההקלטות למייל (מיד בסיום השיחה).

queue_record_send_mail=yes
אם ברצונכם שהדוחות ישלחו למייל בסיום כל שיחה (בטבלה יהיה דוח כל השיחות מהיום ועד לשיחה האחרונה) יש להגדיר

queue_log_send_mail=yes
כדי לקבל מייל על שיחות שלא נענו ע"י נציג, אם לקוח ניתק או יצא מהתור או על כל שיחה שנכשלה יש להגדיר

queue_no_continue_send_mail=yes
ברירת מחדל כאשר מוגדר לשלוח למייל זה נשלח לכתובות ועם השם המופיעים בהגדרות המשתמש שלכם ניתן להגדיר שבשלוחה זו האימייל ישלח למייל אחר וכן ניתן להוסיף בשם של הנשלח בנוסף על מה שכתוב במשתמש

queue_email_address=aa@a.co.il
queue_email_name=משה מחלקת ניהול נציגים
עד כאן ההגדרות בקובץ הגדרות שלוחה ext

 2  
ששמחה - זו הסיסמא  24 ביוני 2021, 12:34
זמני החיוג לנציגים, ומנוחה בין שיחה לשיחה הגדרות בקובץ queue.ini ⬆
אם ברצונכם שהנציג שמקבל את השיחה ישמע כמה זמן הלקוח המתין על הקו "זמן ההמתנה" X "דקות" וX"שניות" יש להגדיר

reportholdtime=yes
שימו לב, לא הלקוח שומע זאת אלא הנציג המקבל שומע כמה זמן הלקוח המתין על הקו

במקרה שהגדרתם את ההגדרה הנ"ל מומלץ גם להגדיר את ההגדרה הבאה
ניתן להגדיר שאחרי שהנציג ענה לשיחה, לפני שהוא מתחיל לשמוע את הלקוח על הקו, תחכה מספר שניות נוספות לפני שהלקוח שומע את הנציג (ממשיך לשמוע מוזיקה בהמתנה ורק לאחמ"כ ישמע את הנציג,) אם יש הודעה לפני שהנציג שומע reportholdtime אז הזמן יהיה לפני תחילת ההודעה של זמן ההמתנה ברירת מחדל 0

memberdelay=5
בדוגמא כאן יחכה 5 שניות

ברירת מחדל מיד בסיום השיחה המערכת שולחת לנציג שיחה חדשה, אם ברצונכם לתת לנציגים זמן מנוחה ניתן להגדיר

wrapuptime=15
בדוגמא, המערכת לא תשלח שיחה נוספת 15 שניות

כמה זמן חיוג לנציג ללא מענה נחשב שהנציג לא ענה ברירת מחדל 23 שניות ניתן לשנות

timeout=20
אם הנציג דחה את השיחה או שהקו היה תפוס האם לאפס את הזמן של הכשלון של הנציג
כלומר לא נתייחס לזה כאלו שהוא לא ענה, וננסה שוב לחייג אליו לפני שמסמנים אותו שלא ענה
(במידה והנציג לא ענה ולא דחה את השיחה, אז המערכת ממשיכה לנציג הבא ללא איפוס הזמן)
ברירת מחדל לא, כלומר אם דחה את השיחה או שהקו תפוס מיד ממשיך לנציג הבא
אם רוצים שינסה עדיין בסיבוב הנוכחי מיד לצלצל שוב יש להגדיר

timeoutrestart=yes
אחרי שכל הנציגים לא ענו, כמה זמן לחכות לפני שמתחילים את הסבב הבא של החיוגים אליהם
ברירת מחדל 5 שניות

retry=10
כאן מוגדר לחכות 10 שניות ואז להתחיל את הסיבוב מההתחלה

האם לאפשר חיוגים נוספים לאותו נציג במהלך השיחה
ברירת מחדל ברגע שנציג ענה לשיחה המערכת מסמנת שהנציג בשיחה , ולא תתקשר אליו עוד פעמים - כלומר הנציג לא ישמע כל הזמן שיחה ממתינה מהלקוח הבא שמחכה. אם ברצונכם לאפשר שיהיה שיחה ממתינה ברקע כלומר המערכת "תזרים" אליכם עוד שיחות גם כשאתם בתוך שיחה מהמערכת אז הגדירו

ringinuse=yes
 3  
ששמחה - זו הסיסמא  24 ביוני 2021, 12:35
הגדרות והודעות בזמן ההמתנה - יש להגדיר בקובץ queue.ini ⬆
ברירת המחדל אין הגבלה על כמות האנשים שממתינים בתור (0 = ללא הגבלה)
באם אתם רוצים שבמידה ויש מעל כמות מסוימת התור יכשל והמתקשר יעבור לאיפוא שמוגדר בערך queue_end_full_goto יש להגדיר

maxlen=3
בדוגמא רק 3 ממתינים יכולים להמתין והרביעי כבר לא יכנס לתור
החישוב הוא נציגים + ממתינים
שימו לב גם שיחות פעילות עם הנציגים נחשבות, כלומר במידה ויש לכם 2 נציגים וכתבתם מקסימום 3 אז רק אחד יכול להמתין בתור פלוס 2 שמדברים עם הנציגים.
תוכלו להגדיר לאן לעבור במצב שאין מקום בתור queue_end_full_goto= את ההגדרה יש לכתוב בקובץ ext.ini

האם להודיע על מיקומך בתור
ברירת מחדל משמיע, אם ברצונכם להגדיר שלא ישמיע יש להגדיר

announce-position=no
אם רוצים שישמיע רק למי שנמצא עד מיקום מסויים או ממיקום מסויים יש להגדיר קודם כל את הגבול

announce-position-limit=5
לאחמ"כ יש להגדיר האם להשמיע רק למי שהמיקום שלו יותר מהגבול, לדוגמא אם הגבול הוא 5 אז תודיע החל מהשישי את ההודעות של המיקום

announce-position=more
אם רוצים שרק מי שהמיקום שלו נמוך מהגבול אם ההגבלה היא 5 אז תודיע רק ל5 הראשונים בתור את המיקום שלהם וכל אלו שממתינים ומיקומם גבוה לא ישמעו את המיקום

announce-position=limit
כל כמה זמן להשמיע על מיקומך בתור ברירת מחדל משמיע כל 60 שניות ניתן לשנות

announce-frequency=90
בדוגמא כאן משמיע כל 90 שניות אם מוגדר 0 אז לא משמיע בכלל.

הערה: אם הגדרתם זמן בערך =min-announce-frequency אז הוא לא יתחשב בערך הנוכחי

השמעת זמן ההמתנה המשוער
ברירת מחדל לא משמיע (לפעמים הזמן לא מדוייק כדאי לשקול האם לשים או לא) אם רוצים שישמיע בכל פעם שמשמיע את המיקום בתור יש להגדיר

announce-holdtime=yes
בכל פעם שמשמיע "מיקומך בתור" משמיע גם "זמן ההמתנה המשוער"

אם רוצים שישמיע רק בפעם הראשונה שנכנס לתור יש להגדיר

announce-holdtime=once
באם זמן ההמתנה נמוך מ1 דקה המערכת בכל מקרה לא תשמיע את זמן ההמתנה המשוער

האם להשמיע בזמן ההמתנה המשוער גם שניות ולכמה זמן לעגל את השניות בזמן ההמתנה המשוער
אם מוגדר 0 אז ישמיע רק את הדקות

announce-round-seconds=0, 5, 10, 15, 20, 30.
אם ברצונכם להגדיר זמן מינימלי שצריך לעבור עבור בין הודעות של מיקום / זמן ההמתנה

min-announce-frequency=50
זה גורם שהמתקשר לא ישמע הודעה אחת אחרי השניה ללא הפסקה, במידה ויש הודעות ארוכות
הערך הזה מבטל את ערך announce-frequency

הודעות מיוחדות בזמן ההמתנה בתור
ברירת מחדל משמיע את ההודעה הבאה כל 60 שניות
M2780 נציגנו עוסקים כרגע בפניות קודמות אנא המתן ותענה לפי התור. (ניתן כמובן להחליף את ההקלטה)
ניתן להגדיר שישמיע אחרי זמן אחר לדוגמא

periodic-announce-frequency=90
בדוגמא ישמיע את ההודעה - כל 90 שניות (כל דקה וחצי) אם ברצונכם לבטל את השמעת ההודעה לגמרי הגדירו

periodic-announce-frequency=0
כלומר להשמיע כל 0 שניות - דהיינו לא להשמיע

הגדרה זו מתחשבנת מתחילת ההודעה אם תרצו שהמערכת תחשב את הזמן שבין ההודעות בלי לכלול את הזמן של ההודעה עצמה הגדירו

relative-periodic-announce=yes
הבהרה חשובה בקשר להודעות במהלך מוזיקה בהמתנה לתור
שימו לב כי שיחות אינן נכנסות למענה בתור בזמן שהמערכת משמיעה את ההודעות, כך שיתכן שמיקום 2 ברשימה יכנס בדיוק באותם שניות במקום מספר 1
לדוגמא: הממתין הראשון בתור מתחיל לשמוע "הנך ראשון בתור" ובדיוק באותה השניה התפנתה השיחה, אז ממתין 2 שהוא בתוך התור מועבר לנציג, כי ממתין 1 באותה השניה ממש שומע הודעה מחוץ לתור (ההודעה הינה מחוץ לתור) ואז חוזר לתור.
עם זאת מניסיון של מליוני משתמשים במודול זה בעולם, מדווחים כי זה לא מורגש בכלל ואין שום מניעה להשתמש בזה.
ניתן במידת הצורך במקום להשתמש בהודעה שמושמעת במהלך התור, לערוך את המוזיקה בהמתנה של התור ואז הלקוח יכול לעבור לנציג בכל שלב.

 2  
ששמחה - זו הסיסמא  24 ביוני 2021, 12:39
יציאה מהתור במהלך התור הגדרות בקובץ queue.ini
ברירת מחדל לא ניתן לצאת במהלך התור כלל, ניתן להגדיר שיצא בהקשה על 9, (השימוש בד"כ ליציאה להשארת הודעה וכדו') ההגדרה היא

context=IVR2_QueueExit9
במידה וכבר היה מוגדר יציאה וברצונכם לבטל את האפשרות של יציאה יש להגדיר

context=no
אם לא היה מוגדר כלום אין צורך להגדיר.
להסבר איך מגדירים יציאה להשארת מספר לחזרה ראה כאן

 2  
ששמחה - זו הסיסמא  24 ביוני 2021, 13:02
הנציגים אליהם התור יחייג ואסטרטגיית התור, הגדרות בקובץ queue.ini ⬆
דבר ראשון יש לרשום בקובץ את מספרי הטלפון של הנציגים, לדוגמא:

0771234567
0504199999
חיוג ישיר לשלוחת SIP
יש אפשרות לחייג ישר לחשבון SIP
על מנת לחייג לחשבון SIP - בשרת תומך (כיום זה נתמך רק ב-ymta) - יש להוסיף את שם המשתמש של חשבון הסיפ תוך כדי ציון של SIP- (אותיות גדולות) בהתחלה והחלפה של = לחשבון משנה במערכת ב - להלן כמה דוגמאות:

הכוונה בהחלפה של = ל - היא שהרי חשבון SIP משנה של מערכת מקבל את המספר של המערכת בתוספת = ומספר החשבון, למשל:

ffb21fa5-db0d-42e2-9aad-b48a20bc4b8d-image.png
הכוונה היא להחליף את = כאשר מכניסים לחיוג ב -.

//לחיוג לחשבון סיפ מספר 3 של מערכת 0773137770
SIP-0773137770-3
 
//לחיוג לחשבון סיפ הראשי של מערכת 0773137770
SIP-0773137770
 
//לחיוג לחשבון סיפ מספר 4 של מערכת 0773137770
SIP-0773137770-4
באם השיחה נענתה על ידי שלוחת SIP לא יהיה חיוב יחידות.

באיזה אסטרטגיה להפעיל את התור
ברירת מחדל מצלצל לכל הנציגים ביחד עד שהראשון עונה

strategy=ringall
יתחיל תמיד מהמספר הראשון ברשימה, יעבור לשני וכן הלאה

strategy=linear
אסטרטגיית מעגל התחלות

strategy=roundrobin
לדוגמא מוגדר 3 סוכנים
אז בשיחה הראשונה יתחיל 1>2>3 , בשיחה השניה 2>3>1 , בשיחה השלישית 3>1>2
שימו לב כאן מתייחסים להתחלות שיחה ולכן אם לדוגמא הלקוח הראשון שצלצל השיחה לא נענתה על ידי הנציג הראשון ועברה לנציג השני ונענתה על ידו
באסטרטגיה זו בפעם השניה נתחיל שוב עם הנציג השני מכיוון שההתחלה בשיחה הראשונה היתה על ידי הנציג הראשון ולכן עכשיו ההתחלה שייכת לנציג השני

אסטרטגיה מעגל שיחות נענות

strategy=rrmemory
לדוגמא אם השיחה הראשונה צלצלה לנציג הראשון ולא נענה ואז צלצלה לנציג השני וכן נענה
אז בפעם הבאה המערכת תצלצל לנציג הבא מהנענות כלומר תתחיל עם הנציג השלישי

שיתחיל דווקא את הנציגים שחייגו אליהם הכי פחות שיחות לאחרונה

strategy=leastrecent
שיתחיל דווקא עם הנציגים שענו הכי פחות שיחות לאחרונה

strategy=fewestcalls
רנדומלי כך שכל פעם יחייג למשהו שונה מהרשימה

strategy=random
 3  
ששמחה - זו הסיסמא  24 ביוני 2021, 13:13
מוזיקה בהמתנה הגדרות בקובץ queue.ini ⬆
ברירת מחדל:

musicclass=default
אם רוצים שישמעו את החיוג עצמו מה שהטלפון של הנציג משדר ולא את המוזיקה בהמתנה ניתן להגדיר

musicclass=no
אם רוצים שתושמע מוסיקה ווקאלית (לימי ספירת העומר/שלושת השבועות) ניתן להגדיר:

musicclass=Vocal
או מוזיקה אישית בהגדרה בשירות לקוחות (בתשלום)
ניתן להוסיף מוזיקה בהמתנה בצורה עצמאית ראה כאן

 4  
ששמחה - זו הסיסמא  25 ביוני 2021, 16:04
ניתן להגדיר שההגדרות שמגדירים בקובץ queue ילקחו משלוחה אחרת - יש להגדיר בקובץ ext ⬆
ניתן להגדיר שכל ההגדרת ששייכות לקובץ queue.ini ילקחו משלוחת היעד
המטרה של הגדרה תור לשלוחה אחרת היא לצורך הגדרות שונות בכניסה ויציאה, הגדרות שונות למעבר בסיום תור וכדומה, וכן להגדרת "עדיפות" שונה בכניסה לתור.
להגדרת העלה על שלוחה אחרת הגדירו

queue_folder_play=5/8
ראו עוד טעינת הגדרות תור ומספרים לחיוג ב-API

 3  
ששמחה - זו הסיסמא  25 ביוני 2021, 16:09
דוחו"ת ⬆
ניתן לערוך את דוחו"ת html
הגדרות ברירת מחדל לקובץ LogQueueAll.ini

LogQueueAll=דו"ח כללי שיחות בתור
Folder=שלוחה
DID=מערכת
IdType=סוג זיהוי
teudat_zehut=תעודת זהות
digits=הקשת ספרות
list=רשימה
phone=טלפון
enter_phone_list=רשימת טלפונים
phone_or_enter_phone=בחירת טלפון
list_all_information=קובץ מידע
phone_from_list_all_information=טלפון מקובץ מידע
EnterId=מספר זיהוי
ValName=שם
School=תאור מוסד
Phone=טלפון
Date=תאריך
Time=שעה
HebrewDate=תאריך עברי
Module=סוג שלוחה
queue=תור
QueueStatus=מצב התור
CONTINUE=הצלחה
TIMEOUT=נגמר הזמן ללא מענה
FULL=תור מלא
JOINEMPTY=תור ללא מספרים
LEAVEEMPTY=עזב
;JOINUNAVAIL
;LEAVEUNAVAIL
Hangup=ניתוק
DialTime=אורך כלל השיחה
QueueTotalSeconds=אורך שהייה בתורים בשניות
QueueTotalTime=אורך שהייה בתורים 
QueueWaitingSeconds=אורך המתנה למענה בשניות
QueueWaitingTime=אורך המתנה למענה
AnswerNumber=מספר שענה 
AnswerSeconds=אורך מענה בשניות
AnswerTime=אורך מענה שיחה
ApiSandAnswer=תשובת שרת
 
הגדרות ברירת מחדל לקובץ LogQueueOK.ini

LogQueueOK=דו"ח שיחות נענות בהצלחה בתור
Folder=שלוחה
DID=מערכת
IdType=סוג זיהוי
teudat_zehut=תעודת זהות
digits=הקשת ספרות
list=רשימה
phone=טלפון
enter_phone_list=רשימת טלפונים
phone_or_enter_phone=בחירת טלפון
list_all_information=קובץ מידע
phone_from_list_all_information=טלפון מקובץ מידע
EnterId=מספר זיהוי
ValName=שם
School=תאור מוסד
Phone=טלפון
Date=תאריך
Time=שעה
HebrewDate=תאריך עברי
Module=סוג שלוחה
queue=תור
DialStatus=מצב השיחה
CONGESTION=שגיאה
NOANSWER=אין תשובה
BUSY=עסוק
ANSWER=נענה
CANCEL=ביטול
Hangup=ניתוק
NotActive=תור לא פעיל
DialTime=אורך כלל השיחה
AnswerTime=אורך מענה 
AnswerSeconds=אורך מענה בשניות
AnswerNumber=מספר שענה 
ApiSandAnswer=תשובת שרת
 
 
לתשומת לב במקרה שרוצים שבמקום מספר הטלפון של הנציג שענה יהיה כתוב משהו אחר יש להגדיר כך

AnswerNumber+054840000=הנציג משה
תצוגת דוחות
דוח נענות בהצלחה.jpg
דוח שיחות כללי.jpg

 3  
ששמחה - זו הסיסמא  28 ביוני 2021, 19:24
הודעות מערכת קשורות ⬆
M1460 אין מספרים לחיוג אנא הוסיפו מספרים לחיוג ונסו שנית
M2780 נציגנו עסוקים כרגע בפניות קודמות אנא המתן ותענה לפי התור
M2781 תודה על סבלותכם
M2782 הנך ראשון בתור
M2783 מיקומך בתור הוא
M2784 מחכה לשיחה עם נציג
M2785 זמן ההמתנה הממוצע הוא כ..
M2786 דקות
M2787 שניות
M2788 פחות מ...
M2789 זמן ההמתנה
M3790 התור סגור כעת, אנא נסה שנית בשעות הפעילות

ערכים שלא נבדקו לעומק
לא מומלץ להשתמש למערכת חיה אם משהו בודק נשמח שיעדכן מה עלה בבדיקתו

ברירת מחדל נציג שלא ענה לא מושהה מהתור
כלומר בפעם הבאה שינסו לחייג אפילו במהלך אותה המתנה של הלקוח
המערכת תנסה שוב לאותו מספר
אם ברצונכם שלקוח שלא ענה יושהה מהתור הגדירו

autopause=yes
האם לשמור הסטטיסטקות של התור כגון אורך שיחות נענות לצורך אורך שיחה וכדומה

keepstats=no
הגדר כמה זמן ממוצע אתה מעריך לשיחה לצורך ההשמעה של אורך השיחה ללקוח

servicelevel=60
הערה: לא ראיתי שההגדרות האלו משפעיות על השמעת אורך ההמתנה
זה בפועל נגזר ממוצע של השיחות הממתינות תוך כדי

האם להכניס כאשר התור יכשל
ברירת מחדל ריק כלומר יתן להיכנס בכל מקרה
ניתן לסמן עם פסיקים כמה אפשרויות מה מוגדר כשלון

joinempty=paused|penalty|inuse|ringing|unavailable|invalid|unknown|wrapup
האם להשאיר את הלקוח בתור כאשר התור יכשל
ברירת מחדל ריק כלומר יתן להשאר בכל מקרה
ניתן לסמן עם פסיקים כמה אפשרויות מה מוגדר כשלון

leavewhenempty=paused|penalty|inuse|ringing|unavailable|invalid|unknown|wrapup
 4  
אחרי חודשיים
ממנחם ימות המשיח  17 באוג׳ 2021, 18:57
שליחה לשרת חיצוני של סטטוס סיום הלקוח בתור יש להגדיר בקובץ ext ⬆
המערכת תשלח מיד לאחר יציאת לקוח מהתור את כל הפרטים שהיה בתור
אותם פרטים שנמצאים בקובץ LogQueueAll.ymgr

ערכי חובה

queue_api_send=yes
queue_api_link=abc.co.il
ברירת מחדל get ניתן לשנות שליחה לpost

queue_api_url_post=yes
במידה ועניתם בהצלחה
יצטרף לדוח LogQueueAll.ymgr
התשובה שעניתם מהשרת על שליחת כל הפרטים (מקסימום 5 תווים לצירוף לדו"ח)

הערך בדוח יהיה
ApiSandAnswer=תשובת שרת

הפרטים שנשלחים לשרת

{
	"CustomerDID":"0772222770",	///	מספר מערכת (ראשי)
	"RealDID":"0773137770",	///	מספר מחויג (במקרה של חיוג למספר משנה, יופיע כאן מספר שונה מהערך הקודם)
	"Folder":"2",	///	שלוחה
	"Phone":"0533137770",	/// מספר מחייג
	"Date":"07/11/2022",	///	תאריך
	"Time":"14:52:14",	///	שעה
	"HebrewDate":"י״ג חשוון תשפ״ג",	///	תאריך עברי
	"Module":"queue",	///	סוג המודול
	"QueueStatus":"CONTINUE",	///	סטטוס שיחה
	"QueueTotalSeconds":7,	///	זמן שיחה כללי בשניות
	"QueueTotalTime":"0:0:7",	///	זמן שיחה כללי
	"QueueWaitingSeconds":5,	///	זמן המתנה למענה בשניות
	"QueueWaitingTime":"0:0:5",	///	זמן המתנה למענה
	"AnswerSeconds":2,	///	אורך שיחה בשניות
	"AnswerTime":"0:0:2",	///	אורך שיחה
	"AnswerNumber":"SIP-0772222770-1",	///	מספר שענה לשיחה
	"QueueRecordPath":"/Trash/QueueRecord/CustomerDID-0772222770-Phone-0533137770-Folder-2-DialTo-SIP-0772222770-1-Date-2022-11-07-14-52-14.wav",	///	נתיב להקלטת שיחה
	"YemotCallID":"bf8b4cf6-e0d8-44e7-a495-098d9a7162df",	///	מזהה שיחה
	"YDTimestamp":1667825534718	///	unix timestamp
}
הערה לגבי הנתיב של הקלטת השיחה: כדי לגשת להקלטה באמצעות הAPI (UploadFile, DownloadFile, FileAction וכדומה) יש להוסיף בתחילת הנתיב ivr2:/

 3  
אחרי 12 חודשים
Eeliyahu ניהול  לפני 3 חודשים
טעינת הגדרות תור ומספרים לחיוג ב-API הגדרות בקובץ ext ⬆
כברירת מחדל המערכת טוענת את הגדרות התור והמספרים לחיוג מקובץ queue.ini כמבואר למעלה.
ניתן להגדיר שנתוני התור יטענו בAPI.
ההגדרה היא

queue_url_link=https://example.com/queue.php
כמובן שאחרי ה= יש לרשום את ה-URL של השרת שלכם
במקרה כזה, בכל כניסה של משתמש לשלוחה תתבצע פנייה בAPI לקבלת נתוני התור.
את תגובת השרת יש להחזיר בהתאם לפורמט המובא להלן.
במידה ואין התייחסות בתגובת השרת להגדרות התור, המערכת תטען את ההגדרות מקובץ queue.ini.
במקרה של סתירה בהגדרות התור בין המופיע בתגובת השרת למופיע בקובץ queue.ini, ההגדרות המופיעות בתגובת השרת גוברות.
את רשימת המספרים לחיוג המערכת טוענת אך ורק מתגובת השרת. ולא מקובץ queue.ini.

פרמטרים המצורפים לשליחה
 

פרמטרים ברירת מחדל
כברירת מחדל המערכת מצרפת לכל פנייה פרמטרים הכוללים מידע על השיחה
הפרמטרים המצורפים הם

ApiCallId=מזהה ייחודי לאורך השיחה
ApiPhone=מספר הטלפון של המשתמש
ApiDID= מספר טלפון הראשי של המערכת שלכם
ApiRealDID=המספר אליו חייג המשתמש.
(במידה ויש כמה מספרים למערכת שלכם, והמשתמש חייג למספר משנה, הערך הזה יהיה שונה מהערך הקודם)
ApiExtension=שם התיקייה/שלוחה בה נמצא המשתמש
ApiEnterID=במידה ובוצעה התחברות לפי זיהוי אישי, יצורף ערך זה המכיל את סוג ההתחברות וה-ID של המשתמש (מידע נוסף כאן)
ApiEnterIDName= שם משויך לזיהוי האישי (כפי שמוסבר כאן)
ApiTime= זמן בשניות מ1970, Epoch, i.e., since 1970-01-01 00:00:00 UTC.
כדי לבטל את שליחת הפרמטרים הנ"ל או את חלקם יש להגדיר (בהתאמה)

queue_api_did_send=no /// Deleting a parameters "ApiDID" "ApiRealDID"
queue_api_phone_send=no /// Deleting a parameter "ApiPhone"
queue_api_extension_send=no /// Deleting a parameter "ApiExtension"
queue_api_enter_id_send=no /// Deleting a parameter "ApiEnterID"
queue_api_enter_id_name_send=no /// Deleting a parameter "ApiEnterIDName"
queue_api_time_send=no /// Deleting a parameter "ApiTime"
 

פרמטרים קבועים
ניתן להגדיר שבכל פנייה, המערכת תצרף פרמטרים קבועים שיישלחו לשרת.

(הערה: לא ניתן לצרף פרמטרים הנשלחים כברירת מחדל)
לדוגמה אם ברצונכם שבכל פנייה לשרת המערכת תצרף את הפרמטרים p1=v1 p2=v2 יש להגדיר בהגדרות השלוחה

queue_api_add_0=p1=v1
queue_api_add_1=p2=v2
במקרה כזה הבקשה ב-GET תראה כך

https://example.com/queue.php?p1=v1&p2=v2
כמובן שניתן לצרף פרמטרים נוספים (queue_api_add_X=), כשבמקום X יש לרשום את מספר הפרמטר.
שימו לב שחשוב לשמור על רצף סידורי החל מהספרה 0.

מתודת שליחה
כברירת מחדל הפנייה נשלחת בHTTP GET
אם ברצונכם שהפנייה תישלח בHTTP POST יש להגדיר

queue_api_url_post=yes
תגובת שרת
את תגובת השרת יש להחזיר בתבנית JSON.
הנתונים שניתן להחזיר הם

{
	"description" : x,
	"queueactive" : x,
	"autofill" : x,
	"context" : x,
	"monitor-type" : x,
	"monitor-format" : x,
	"servicelevel" : x,
	"keepstats" : x,
	"maxlen" : x,
	"autopause" : x,
	"announce-position" : x,
	"announce-position-limit" : x,
	"announce-holdtime" : x,
	"announce-frequency" : x,
	"relative-periodic-announce" : x,
	"random-periodic-announce" : x,
	"min-announce-frequency" : x,
	"announce-round-seconds" : x,
	"periodic-announce" : x,
	"periodic-announce-frequency" : x,
	"reportholdtime" : x,
	"strategy" : x,
	"joinempty" : x,
	"leavewhenempty" : x,
	"retry" : x,
	"wrapuptime" : x,
	"timeout" : x,
	"timeoutrestart" : x,
	"musicclass" : x,
	"ringinuse" : x,
	"queue-thankyou" : x,
	"queue-youarenext" : x,
	"queue-thereare" : x,
	"queue-callswaiting" : x,
	"queue-holdtime" : x,
	"queue-minutes" : x,
	"queue-seconds" : x,
	"queue-less-than" : x,
	"queue-reporthold" : x,
	"members" : [
		"0507707701",
		"SIP-0773137770"
	]
}
בפרמטר members יש להחזיר את רשימת המספרים לחיוג.
שאר הפרמטרים אופציונליים. כל פרמטר שלא צוין (מלבד members) יקבל את ההגדרה מקובץ queue.ini אם קיים (במידה ולא קיים יחולו הגדרות ברירת המחדל). יש לשלוח ב JSON רק פרמטרים שאכן רוצים להגדיר.

