ב"ה

אפשרות להגביל את כמות הזמן שהלקוח יישאר במערכת שלכם - limit call seconds
הסבר על המודול:

כידוע (למי שמכיר) יש בנגנים למיניהם "זמן שינה" שזה אומר שאם מישהו הולך לישון והוא רוצה לשמוע שיעור עד שהוא נרדם. אז הוא קורא קריאת שמע בכוונה מכין "נעגל וואסר" ונכנס למיטה...
אז הוא נכנס להגדרות של הנגן ועושה "טיימר" שמעכשיו יספור שלושים דקות (למשל)
וכשיעבור הזמן הזה - הנגן יכבה - לא משנה איפה הוא אוחז בשיעור,
ככה לא יגמר לו הבטריה, (וכן בפעם הבאה הוא יוכל לחזור למיקום שבו הוא הפסיק)

ולעניינינו - ניקח לדוגמה - אנחנו מעלים למערכת דיסק חדש
ואנחנו רוצים שרק מי ששילם יוכל לשמוע
אבל אנחנו רוצים "לגרות" את המאזינים ולהשמיע להם קטע מתוך הדיסק
(אז נכון שאפשר לערוך את הדיסק עם תוכנות ולהעלות קובץ של קטעים, אבל יש דרך לעשות זאת במערכת)

אנחנו ניקח שלוחה שהיא תהיה שלוחת הטיימר - לצורך העניין שלוחה 4
ונגדיר שמי שנכנס לתוך השלוחה הזאת - אחרי שלוש דקות מתנתק השיחה
ונגדיר שלאחר שנכנס לשלוחה הזאת הוא ממשיך לשלוחה 1 (בתוך שלוחה 4) ששלוחה 1 הזה יהיה המוזיקה

אז יוצא שהמאזין נכנס לשלוחה 4 (ובלא ידיעתו) הוא מועבר לשלוחה ארבע > אחד
ושומע מוזיקה להנאתו
אך לכשיעברו שלושת הדקות שהקצבנו הוא ישמע הודעה (שאנחנו נקליט) "מאזין יקר, על מנת לשמוע את המשך הדיסק עליכם לשלם..."
ויתנתק השיחה או שיעבור לשלוחה של תשלום לפי מה שנגדיר

בהצלחה

ועכשיו להגדרות
ישנם שתי אופציות:
1- להגדיר את הטיימר בתור שלוחה בפני עצמה, (כפי שכתבתי למעלה).
2- להכניס את זה בתוך שלוחה, דהיינו כתוספת למודול אחר.

הפעלה כמודול נפרד

type=limit_call_seconds
הפעלת ההגבלה בכל מודול אחר

limit_call_seconds=yes
הגדרות נוספות
אורך הטיימר
ניתן להגדיר את אורך הטיימר בכמה צורות (ראה להלן דוגמאות והסבר)

אורך קבוע. לדוגמה, חצי שעה מרגע הכניסה לשלוחה.
אורך משתנה לפי שעה ביום. כלומר, אורך הטיימר ייקבע לפי הזמן שנשאר עד שעה מסוימת. בהגיע השעה היעודה הטיימר יסתיים.
אורך משתנה לפי זמן ספציפי. כלומר, אורך הטיימר ייקבע לפי הזמן שנשאר עד הזמן שהוגדר. בהגיע הזמן הרצוי הטיימר יסתיים.
אורך משתנה לפי זמן משתנה.
דוגמאות

limit_call_seconds_disconnect_time=180
limit_call_seconds_disconnect_time=15:30
limit_call_seconds_disconnect_time=15:30:30
limit_call_seconds_disconnect_time=2022-05-25-00-00-00
limit_call_seconds_disconnect_time=sunset,,+,m2
בדוגמה הראשונה אורך הטיימר יהיה 180 שניות (3 דקות)
שימו לב! ההגדרה היא בשניות.

בדוגמה השנייה, אורך הטיימר ייקבע לפי הזמן שנשאר עד השעה 15:30 (פורמט hh:mm)

בדוגמה השלישית, אורך הטיימר ייקבע לפי הזמן שנשאר עד השעה 15:30:30 (פורמט hh:mm:ss)

בדוגמה הרביעית, אורך הטיימר ייקבע לפי הזמן שנשאר עד תאריך 25/05/200 בשעה 00:00:00 (פורמט yyyy-mm-dd-hh-mm-ss)

בדוגמה החמישית, אורך הטיימר ייקבע לפי הזמן שנשאר עד שעתיים אחרי השקיעה.
ההגדרות לזמן משתנה מורכבות מ-4 סוגי משתנים שונים ויש להפריד ביניהם עם פסיק

המשתנה הראשון - סוג זמן. למידע אודות סוגי הזמן הקיימים במערכת לחצו כאן
המשתנה השני - אזור זמן. למידע אודות אזורי הזמן הקיימים במערכת לחצו כאן
במשתנה השלישי ניתן להגדיר האם להפחית מהזמן שצוין או להוסיף על הזמן. כדי להפחית יש לרשום - כדי להוסיף יש לרשום +
במידה ובחרתם במשתנה השלישי בהוספה או הפחתה של זמן, יש לציין במשתנה הרביעי את כמות הזמן הרצויה וכדלהלן:
את כמות הזמן הרצויה כדלהלן:
תחילה יש לציין את פונקציית הזמן. האפשרויות הן
Y - שנה
M - חודש
D - יום
H - שעה
m - דקה
S - שניה
s - אלפית שניה
לאחר מכן יש לרשום במספר את הכמות הרצויה.
למשל, עבור 20 דקות יש להגדיר m20 עבור 3 שעות יש לרשום H3. עבור יום אחד יש לרשום D1.
במידה ולא הוגדר אורך, ברירת מחדל אורך הטיימר הינו 1800 שניות, דהיינו חצי שעה.

מה יקרה לאחר שהמאזין נכנס לשלוחה והמערכת הגדירה לו את הטיימר

באם הפעלתם את ההגבלה כמודול בשלוחה בפני עצמה (אופציה א) - ברירת מחדל לאחר הפעלת המודול - המערכת עוברת בצורה אוטמטית לשלוחה 1 שבתוך שלוחת הטיימר

באם ברצונכם שיעבור לשלוחה אחרת לאחר הפעלת המודול ניתן להגדיר:

limit_call_seconds_ivr_start=/4/1
בדוגמא הנוכחית יעבור לשלוחה 4 > 1 (כמו בהסבר למעלה) | ראה כאן את כל אפשרויות הגדרת הניתוב כולל ניתוק.

כל הנ"ל לא רלוונטי במידה והפעלתם את ההגבלה כהוספה למודול אחר ולא כמודול נפרד - כי אז המערכת לא מעבירה את המאזין לשלוחה אחרת אלא ממשיכה באותה שלוחה.

במידה והפעלתם כמודול נפרד (אופציה א) - אז ניתן להכניס קובץ M0000 בשלוחה בכדי להשמיע מייד בכניסה לשלוחה (כמו בכל המודלים)

מה יקרה כשעבר הזמן שהגדרנו לטיימר

לאחר תום הזמן לא משנה באיזה מצב הלקוח נמצא - השיחה פשוט תעזוב לחלוטין את המצב שבו היא נמצאת, ותתקדם הלאה בהתאם לפעולות המופיעות בהמשך.
המערכת תבצע שתי פעולות בהגיע הזמן:
1 - השמעת הודעה,
2- או ניתוק או מעבר לשלוחה אחרת.

שלב 1 - השמעת הודעה
המערכת תשמיע את הודעה מספר 1167
M1167 שלום ותודה
(ניתן להחליף לפי העניין - כמו שכתבתי בהסבר שניתן לעלות לפה הודעה שאם רוצים להמשיך לשמוע אז צריך לשלם)

שלב 2
ברירת מחדל - המערכת מנתקת

ניתן להגדיר לעבור לשלוחה אחרת | ראה כאן את כל אפשרויות הגדרת הניתוב כולל ניתוק.

limit_call_seconds_end_time_go_to=/5/5
הערה חשובה:
לאחר שהמאזין נכנס לשלוחת הטיימר ניתן להישאר רק באותה מערכת ולא ניתן לעשות הפניה למערכת אחרת (routing_yemot), ראה את הפוסט הבא

הערה חשובה:
כל זמן שההגבלה פועלת - גם במידה ותגדירו עוד הגבלה - המערכת לא תתחשב בה - ותמשיך לפי ההגבלה שהיא כבר פועלת
לאחר שהסתיים הזמן - לאחר שהמערכת עוברת לשלוחה שהגדרתם, ניתן להפעיל גם את ההגבלה מחדש.

 11 
אחרי שנתיים
ששמחה - זו הסיסמא  לפני 8 חודשים
עדכון:

לאחר מאמצים מרובים, עלה בידנו פיתרון לבאג שהיה מתקיים בביצוע הגבלת זמן לשיחה/ שלוחה, כשעוברים לחדר וועידה, או שמשתמשים בניתוב השיחה למערכת אחרת, או בניתוב למספר חיצוני.
ולכן חסמנו את האפשרות לשימוש באופציות של ניתוב, לאחר הגדרת הגבלת זמן.
כעת ב"ה ההגבלות הוסרו!
אך שימו לב, במידה ותגדירו מעבר למערכת אחרת, ההגבלה תבוטל.
תוכלו להגדיר במערכת היעד שההגבלה תמשיך, במידה והשיחה עברה ממערכת מסוימת.
לצורך כך יש לרשום בקובץ ההגדרות ext.ini בשלוחת הכניסה, או בקובץivr.ini בשלוחה הראשית:

limit_call_seconds_next=0771234567,0791234567
כאן מופיע שאם השיחה הועברה מהמערכת (מספר ראשי) 0771234567 או 0791234567

ההגבלה תימשך, ובסיום, השיחה תתנתק, או שתעבור לשלוחה שהוגדרה, אבל השלוחה תהיה חייבת להיות קיימת במערכת היעד, ולשם השיחה תעבור.
ייתכן ונפתח בעתיד שהשיחה תוכל לחזור למערכת המעבירה, לתוך השלוחה שהוגדרה.


