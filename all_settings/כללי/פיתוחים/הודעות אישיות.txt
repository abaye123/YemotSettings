
הרשמה
התחברות

הרשמה
התחברות
הודעות אישיות, ושמיעת הודעה "יש לך הודעה אישית חדשה", וכן אופציה לצינתוק
טיפים עצות והדגמות מהמשתמשים   3  3  1.1k
  
HHMJE22  15 בנוב׳ 2020, 0:01
עדכון - יום ד' ג' אלול תשפ"א
בס"ד יש כמה שדרוגים, והתיקונים בקצרה הם, 1. לגבי הבאג שא"א להכנס פעמיים לשלוחת ההודעות אישיות בשיחה אחת, סודר. 2. לגבי הבאג שהיה קומבינה שכל אחד (עם קצת ידע) יכל להאזין להודעות של אנשים אחרים, סודר (בהוספת שלוחת api).

(3. כמות השלוחות ירד מ12 ל-9).
כאן הבאתי כהמשך לאמור בפוסט הזה, אפשרות של שליחת צינתוק לאחר השארת הודעה אישית, (השלוחות שם הם 2 שלוחות api).

יש בפורום הרבה על הענין של הודעות אישיות במערכת IVR.
כאן אני יעלה הגדרות איך לעשות שלוחת הודעות אישיות + שמיעת הודעה מיד בכניסה למערכת "יש לך הודעה אישית חדשה".
לכל הערה והארה בענין, ניתן להגיב כאן

שים לב! הפוסט נראה ארוך ומסובך, אכן הוא ארוך אבל לא כ"כ מסובך, צריך בעיקר סבלנות.

דבר ראשון אני יסביר את הרעיון של הענין, ואחרי זה אני יביא את כל ההגדרות וכו'...

שלוחת ההקלטות, ושלוחת שמיעת ההודעות האישיות בנויות על הבסיס הידוע שכבר הובא הרבה פעמים בפורום, (עם כמה שינויים קלים - כמפורט בהמשך).
הבסיס של הרעיון הוא לעשות, שכשאני מקיש את מספר הטלפון של הנמען בשביל להשאיר לו הודעה, שהמערכת תזכור את המספר בשביל שאחרי שאני שומר את ההקלטה שהמערכת תכניס את זה לרשימה שמי שנמצא ברשימה זו ישמע מיד עם הכניסה למערכת את ההודעה "יש לך הודעה אישית חדשה".
ועל דרך זה גם, שהמאזין ששומע את ההודעה הזאת, כשהוא נכנס לשלוחת הודעות אישיות שיפסיק לשמוע את ההודעה, ע"י הסרת הטלפון שלו מהרשימה הנ"ל, (בדרך אגב, אני עשיתי, שכל זמן שהוא לא נכנס לשלוחת הודעות אישיות, כל פעם שהוא מתקשר הוא ישמע את ההודעה, ורק כשנכנס לשלוחת הודעות אישיות, רק אז הוא יפסיק לשמוע את ההודעה - כמו בוואטצאפון).
4. באחד מההגדרות כנראה שיש באג במערכת של ימות המשיח, (עכ"פ במערכת שלי זה לא עבד), ובגלל זה הייתי צריך להגדיר שיתאפשר להכנס לשלוחת ההודעות האישיות רק פעם אחת בכל שיחה, כפי שיתבאר להלן.
עריכה - סודר בכמה שינויים קטנים בשלוחות הרלוונטיות.

בסופו של דבר כלפי המשתמש, יש 2 הבדלים שזה שונה מהודעות אישיות בוואטצאפון, 1. שלשמיעת הודעות יש להקיש 11, ולא 1 לבד, (עריכה - הבאג שהיה שיכלו להקיש טלפון אחר ולהקשיב להודעות אישיות שלו, סודר בהוספה של שלוחת api... עיין בהמשך). 2. שכאן אין צינתוק כאשר משאירים הודעה אישית חדשה.
עריכה - יש לי כבר רעיון, וכבר עשיתי את זה אצלי, שיש אופציה לקבל גם צינתוק כשמשאירים הודעה אישית... בעז"ה אני יפרסם בזמן הקרוב (יש לציין שיהיה שם כמה שלוחות api, כמובן השימוש הוא לבחירתכם-ובאחריותכם).

עכשיו נביא את כלל השלוחות שצריך לפתוח, ואח"כ נביא את ההגדרות עם ההקלטות המיועדות לה.

אז התחלנו...
בכל המהלך הבא, יש לפתוח 12 9 שלוחות מסוגים שונים כדלהלן, (כשכמה מהם עשיתי בגלל שככה יצא לי שיעבוד טוב, אבל אם מישהו יסתדר עם פחות מזה, תבוא עליו ברכה).
אנחנו הולכים על זה ששלוחת הודעות אישיות הוא בשלוחה 0.

להלן השלוחות...

שלוחה 0 - שלוחת פילטר לפי זמנים, כדי להגדיר כניסה אחת בכל שיחה.

שלוחה 0 - שלוחה שתמחק את המספר טלפון של המאזין מהרשימה בו שומעים את ההודעה "יש לך הודעה אישית חדשה" באם הוא קיים ברשימה.
בתוך שלוחה 0

שלוחה 0 - (דהיינו שלוחה 0/0/), שלוחת תפריט "שלוחת הודעות אישיות".
שלוחה 00 - (דהיינו שלוחה 0/00/), שלוחת תפריט "שלוחת הודעות אישיות מזוייף.
שלוחה 1 - (דהיינו שלוחה 0/1/), שלוחה שתמחק את המספר טלפון של המאזין מהרשימה בו שומעים את ההודעה "יש לך הודעה אישית חדשה" באם הוא קיים ברשימה.

בתוך שלוחה 0/0/

שלוחה 1 - (דהיינו שלוחה 0/0/1/), שלוחת api לאימות הזיהוי, כך שמי שינסה להקשיב להודעות של השני, אין גישה.
שלוחה 2 - (דהיינו שלוחה 0/0/2/), שלוחה להקשת הטלפון של הנמען וגם שהמערכת תזכור את הטלפון כדלעיל.
שלוחה Hash - (דהיינו שלוחה Hash בתוך 0/0/), שלוחת הפעלת שלוחה אחרת - הפניה לשלוחה ראשית.
עריכה + תוספת זיהוי phone כדי שיוכל להיכנס שוב להודעות אישיות באותה שיחה.
בתוך שלוחה 0/0/1/

שלוחה 1 - (דהיינו שלוחה 0/0/1/1/), שלוחת השמעת קבצים, לשמיעת ההודעות אישיות.
בתוך שלוחה 0/0/2/

שלוחה 2 - (דהיינו שלוחה 0/0/2/2/), שלוחת הקלטות.
בתוך שלוחה 0/0/2/2/

שלוחה 1 - (דהיינו שלוחה 0/0/2/2/1/), שלוחה להוספה אוטומטית של מספר הנמען שהקשנו, שיוסיף לרשימה לשמיעת ההודעה "יש לך הודעה אישית חדשה".
נחזור לשלוחה 0/00/ (למי שזוכר שלוחת "הודעות אישיות מזוייף)
שלוחה Hash - (דהיינו שלוחה Hash בתוך 0/00/), שלוחת הפעלת שלוחה אחרת - הפניה לשלוחה ראשית.
עריכה - אין צורך בהנ"ל.

עדיין לא גמרנו...
עכשיו צריך לפתוח את השלוחה בה המאזין ישמע את ההודעה "יש לך הודעה אישית חדשה" בכניסה למערכת, כמובן שצריך להגדיר שכשמחייגים למערכת שיעבור ישר לשלוחה זו, יתבאר בהמשך.
לצורך הענין נפתח שלוחה 999 תחת השלוחה הראשית.

את שלוחה 999 נגדיר שלוחת השמעת קבצים, שבהקשה על מקש 0 יעבור לשלוחה 0 שלוחת ההודעות אישיות, ובהקשה על כל מקש אחר יחזור חזרה לשלוחה ראשית.
את שלוחה 999 נגדיר לשלוחת פילטר, שתמחק את הזיהוי של המאזין משלוחה 0 כדי שיוכל להכנס לשלוחה, (למי שזוכר ששלוחה 0 היא שלוחת פילטר כדי להגדיר כניסה אחת בכל שיחה, בשביל זה צריך שכל אחד יעבור בשלוחה זו למחיקת הכניסות האחרונות שלו, בשביל שיוכל להכנס עכשיו שוב.
בתוך שלוחה 999 נפתח שלוחה 1 - (דהיינו 999/1/), שלוחת השמעת קבצים עם הגדרות נוספות שלא יוכל לצאת ממנה וכו' כמו שיתבאר...
עריכה - אין צורך בהנ"ל.

אז פתחנו 9 שלוחות ב"ה, עכשיו נעבור להגדרות עם ההקלטות המתאימות בס"ד, (ההסבר על כל הגדרה אולי בהמשך אם יהיה צורך כח וזמן, אבל כל מי שירצה יוכל להעתיק ולחפש בפורום, וימצא בקלות הסבר על כל הגדרה).

שלוחה 0/

type=remove_id_from_list
title=הודעות אישיות
remove_id_from_list_key=phone
remove_id_from_list_location_list=/999/WhiteList.ini
remove_id_from_list_mode=key_only
remove_id_from_list_end_goto=0
remove_id_from_list_error_end_goto=0
יש לשנות את קבצי המערכת הבאים לקובץ שקט (מצורף)
M2573
M1080
  %D7%A9%D7%A7%D7%98.wav
שלוחה 0/0/

type=menu
title=הודעות אישיות
hash_extension=yes
קובץ תפריט מצורף
  m1000.wav
שלוחה 0/0/1/
שלוחת api - אימות הזיהוי

type=api
title=אימות הזיהוי
api_link=https://ivr2.000webhostapp.com/php/imut_enter_id.php
api_add_0=go_to_yes=1
api_add_1=go_to_no=..
api_add_2=M1102=yes
 
enter_id=yes
enter_id_type=phone_or_enter_phone
delete_id_exit=yes
enter_id_timeout=1
 
;ביטול הקלטת השם
record_name=no
;שלא ישמיע את השם שהוקלט
say_name=no
יש לשנות את קבצי המערכת הבאים לקובץ שקט (מצורף)
M1121
M1122
  %D7%A9%D7%A7%D7%98.wav
הסבר על הערכים שבשלוחת הapi.
שורה מס' 3, יש להכניס לאן יעבור אם הזיהוי שנכנס איתו הוא אכן הטלפון שלו, (מוגדר שיכנס לשלוחה 1 שבתוך השלוחה, שזה שלוחת שמיעת ההודעות אישיות).
שורה מס' 4, יש להכניס לאן יעבור באם הקיש זיהוי לא שלו, (שאנחנו רוצים שלא יהיה לו גישה להודעות של אחרים, (מוגדר שיחזור שלב אחורה).
שורה מס' 5, אם רוצים שכשנכנס אם זיהוי לא שלו, שישמע הודעה מסויימת, יש להוסיף את שורה מס' 5, ולהעלות קובץ M1102.
(אצלי העלתי קובץ M1102 עם ההודעה "אין לכם הרשאת גישה לתקיה זו" (מצורף).
  m1102.wav

כמובן ניתן להחליף למה שרוצים, או להוריד את השורה הזאת, ואז לא ישמיע כלום.
שלוחה 0/0/1/1/

type=playfile
title=שמיעת הודעות אישיות
say_length=no
 
folder_play=id_record
folder_to_play=/0/0/2/2
enter_id_type=phone_or_enter_phone
delete_id_exit=yes
 
enter_id_timeout=1
 
;ביטול הקלטת השם
record_name=no
;שלא ישמיע את השם שהוקלט
say_name=no
playfile_end_goto=/0/0/Hash
 
control_play4=minus
control_play6=plus
 
;שמיעת פרטי ההשמעה
say_details_message=date,time,phone
details_message_date=heb
;תפריט לאחר ההשמעה
after_play_tfr=tfr_more_options
;הגדרות מקשים לאחר השמעה
control_after_play_moreA0=restart
control_after_play_moreA1=admin_options
control_after_play_moreA3=admin_options
admin_options_open=yes
control_after_play_moreA4=next
 
after_tfr_details_message_next=yes
 
;ביטול מקש 7
control_play7=noop
;ביטול מקש 9
control_play9=noop
 
control_play#=go_to_folder
playfile_control_play_#_goto=/0/0/Hash
 
;פרטי ההשמעה
control_play_moreA1=admin_options
;כוכבית 2 - מבוטל
control_play_moreA2=noop
;כוכבית 3 - מבוטל
control_play_moreA3=admin_options
;להודעה הבאה
control_play_moreA4=next
;שיתוף עם מערכות אחרות
control_play_moreA5=noop
;כוכבית 6 - מבוטל
control_play_moreA6=noop
;כוכבית 7 - מבוטל
control_play_moreA7=noop
;כוכבית 8 - מבוטל
control_play_moreA8=noop
;כוכבית 9 - מבוטל
control_play_moreA9=noop
יש לשנות את קבצי המערכת הבאים לקובץ שקט (מצורף)
M1121
M1122
  %D7%A9%D7%A7%D7%98.wav

ולהעלות את 3 הקבצים הבאים
  m1391.wav

  m1459.wav

  m1559.wav
שלוחה 0/0/2/

עריכה - נוסף מפעם קודמת השורה delete_id_exit=yes

type=go_to_folder
go_to_folder=2
 
enter_id=yes
enter_id_type=phone_or_enter_phone
 
;ביטול הקלטת השם
record_name=no
;שלא ישמיע את השם שהוקלט
say_name=no
delete_id_exit=yes
יש לשנות את קובץ המערכת הבא לקובץ שקט (מצורף)
M1122
  %D7%A9%D7%A7%D7%98.wav

ובנוסף להעלות את הקובץ הבא
  m1121.wav
שלוחה 0/0/2/2/

עריכה - שימו לב, יש כמה שינויים

type=record
;שלא ישמע את מספר הקובץ
say_record_number=no
;שלא יהיה תפריט להקלטה נוספת
say_record_menu=no
 
record_end_goto=1
record_cancel_goto=/0/0/Hash
 
folder_move=id
enter_id=yes
enter_id_type=phone_or_enter_phone
;ביטול הקלטת השם
record_name=no
;שלא ישמיע את השם שהוקלט
say_name=no
 
menu_record_options_1=record_play
menu_record_options_2=record_ok
menu_record_options_3=record_again
menu_record_options_4=record_cancel
menu_record_options_5=noop
menu_record_options_6=continue_recording
menu_record_options_7=noop
menu_record_options_8=noop
menu_record_options_9=noop
יש להעלות את הקבצים הבאים
  m1009.wav

  m1012.wav
שלוחה 0/0/2/2/1/

type=add_id_to_list
add_id_to_list_location_list=/999/WhiteList
add_id_to_list_end_goto=/0/0/Hash
add_id_to_list_error_end_goto=/0/0/Hash
יש לשנות את קבצי המערכת הבאים לקובץ שקט (מצורף)
M3410
M3411
  %D7%A9%D7%A7%D7%98.wav
שלוחה Hash שבתוך 0/0/

עריכה - בשלוחה זו יש שינויים חשובים כדי שיוכל להכנס שוב להודעות אישיות באותה שיחה.

type=go_to_folder
go_to_folder=/
 
enter_id=yes
enter_id_type=phone
;ביטול הקלטת השם
record_name=no
;שלא ישמיע את השם שהוקלט
say_name=no
delete_id_exit=yes
שלוחה 999/

type=playfile
title=יש לך הודעה חדשה
white_list=yes
 
after_play_000_go_to_folder=/
play_beep=no
 
;יציאה בכל מקש
control_play1=go_to_folder
control_play2=go_to_folder
control_play3=go_to_folder
control_play4=go_to_folder
control_play5=go_to_folder
control_play6=go_to_folder
control_play7=go_to_folder
control_play8=go_to_folder
control_play9=go_to_folder
control_play0=go_to_folder
playfile_control_play_0_goto=/0
control_play*=go_to_folder
control_play#=go_to_folder
 
playfile_control_play_goto=/
יש לשנות את קובץ המערכת הבא לקובץ שקט (מצורף)
M1102
  %D7%A9%D7%A7%D7%98.wav

ובנוסף יש להעלות את הקבצים הבאים
  000.wav

WhiteList.ini
(להורדת הקובץ WhiteList.ini יש ללחוץ לחצן ימני בעכבר, ולבחור "שמור קישור בשם...").
לקראת סיום!
נביא כאן את ההגדרות שצריך להגדיר בשביל שכל מי שנכנס למערכת יעבור קודם כל דרך השלוחה של שמיעת ההודעה "יש לך הודעה אישית חדשה".
בקובץ ext.ini שבשלוחה הראשית יש להגדיר

;שמיד בכניסה למערכת שיעבור לפי המופיע בקובץ Did_Go_To.
check_did_and_go_to_folder=yes
;הגדרה שיחסום רק בפעם הראשונה ואחרי זה שיעבור למערכת
check_did_and_go_to_folder_one_time=yes
יש להעלות לשלוחה הראשית את הקובץ הבא
Did_go_to.ini
(להורדה לחץ לחיצה ימנית על העכבר, "שמור קישור בשם...").

דוגמא למופיע בקובץ

0773137770=/999
שימו לב! יש לשנות את המספר 0773137770 למספר המערכת שלכם.

מצורף תיקייה עם כל הקבצים המצורפים מסודר לפי שלוחות
הודעות-אישיות.rar

נ.ב. מי ששם לב שיש ב2 שלוחות את ההגדרה delete_id_exit=yes, הבעיה שזה לא עובד (עכ"פ אצלי), ולכן הייתי צריך להגדיר שיהיה כניסה פעם אחת בכל שיחה לשלוחת הודעות אישיות.

כאן הוספתי עוד קצת הסבר.

לכל הערה והארה בענין, ניתן להגיב כאן
בהצלחה

 21 
AAATEKHHI 331 לפני 5 חודשים
פוסט זה נמחק!
פפישל  לפני 5 חודשים
פוסט זה נמחק!
 2 מתוך 3 
